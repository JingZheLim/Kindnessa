<!DOCTYPE html>
<html lang="en">

<head>
    <title>Kindnessa</title>
    <!-- <link rel="stylesheet" href="index.css"> -->
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../headFoot.css">
    <link rel="stylesheet" href="../stylesheets/newfeeds.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
    <script src="../javascripts/check_login.js" defer></script>
    <script src="../javascripts/logout.js" defer></script>

    <!-- Include Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://kit.fontawesome.com/3b05a2b1b3.js" crossorigin="anonymous"></script>
</head>

<!--Header-->

<body>
    <div class="header-container" id="app">
        <div class="header">
            <a class="logo-color" href="../"><i class="fa-solid fa-hand-holding-heart fa-2xl"></i> Kindnessa</a>
            <a href="../general/about.html">About</a>
            <a href="../general/organisation.html">Organisations</a>
            <a href="../general/newfeeds.html">News Feed</a>
            <a href="../general/event.html">Events</a>
            <a href="../general/contact.html">Contact Us</a>
            <!-- Add login icon -->
            <a v-show="!logged_in" href="../general/login.html" class="login"><i class="fas fa-sign-in-alt"></i> Log
                in</a>
            <div v-show="logged_in" class="dropdown">
                <button type="button" class="dropbtn"><i class="fa-solid fa-user"></i>
                    <i class="fa fa-caret-down"></i>
                </button>
                <div class="dropdown-content">
                    <a href="../user/profile.html">Profile</a>
                    <a v-if="!check_admin" href="../user/joined_events.html">My Events</a>
                    <a v-if="!check_admin" href="../user/joined_orgs.html">My Organisations</a>
                    <a v-if="check_manager" href="../manager" class="manager-tools">Manager
                        Tools</a>
                    <a v-if="check_admin" href="../admin" class="manager-tools">Admin Tools</a>
                    <a href="../general/logout.html" @click="logout()">Log Out</a>
                </div>
            </div>
        </div>
    </div>

    <div id="posts">
        <!--The header-->
        <div class="page-title">
            <div class="inside-page">
                <p>News Feed</p>
            </div>
        </div>

        <main class="main-div">
            <!--Filter Buttons-->
            <div class="filter-buttons">
                <button type="button">ALL</button>
                <button type="button">PUBLIC</button>
                <button type="button">ORGANISATION</button>
            </div>

            <!--Posts-->
            <div class="post">
                <div class="inside-post">
                    <img src="../images/org1_resized.jpeg" alt="p1">
                    <div class="post-content">
                        <h3>Post 1</h3>
                        <p>
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris in posuere dolor.
                            Morbi scelerisque, neque eu laoreet sagittis, ligula felis vulputate ex, a elementum ante ex
                            ut
                            sapien.
                            Vestibulum ut dapibus neque. Cras vestibulum laoreet velit non molestie. Nam pellentesque
                            lorem
                            at
                            elit
                            mattis tincidunt.
                            Sed volutpat efficitur fringilla. Quisque lobortis est sed vulputate malesuada.
                            Mauris sem tellus, condimentum ac vulputate eget, laoreet id nunc.
                            Quisque tincidunt consectetur urna a luctus. Sed porta magna iaculis rhoncus venenatis.
                        </p>
                    </div>
                </div>

                <hr>
                <div class="inside-post">
                    <img src="../images/ike.jpg" alt="p2">
                    <div class="post-content">
                        <h3>Post 2</h3>
                        <p>
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris in posuere dolor.
                            Morbi scelerisque, neque eu laoreet sagittis, ligula felis vulputate ex, a elementum ante ex
                            ut
                            sapien.
                            Vestibulum ut dapibus neque. Cras vestibulum laoreet velit non molestie. Nam pellentesque
                            lorem
                            at
                            elit
                            mattis tincidunt.
                            Sed volutpat efficitur fringilla. Quisque lobortis est sed vulputate malesuada.
                            Mauris sem tellus, condimentum ac vulputate eget, laoreet id nunc.
                            Quisque tincidunt consectetur urna a luctus. Sed porta magna iaculis rhoncus venenatis.
                        </p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!--Footer-->
    <footer>
        <div class="inside-footer">
            <div class="social-links">
                <div class="links">
                    <ul class="social-list">
                        <li class="icons">
                            <a href="https://www.facebook.com" class="facebook">
                                <i class="fa-brands fa-square-facebook fa-2xl"></i>
                            </a>
                            <div class="tooltip">Facebook</div>
                        </li>
                        <li class="icons">
                            <a href="https://www.twitter.com" class="twitter">
                                <i class="fa-brands fa-square-x-twitter fa-2xl"></i>
                            </a>
                            <div class="tooltip">Twitter</div>
                        </li>
                        <li class="icons">
                            <a href="https://www.instagram.com" class="instagram">
                                <i class="fa-brands fa-square-instagram fa-2xl"></i>
                            </a>
                            <div class="tooltip">Instagram</div>
                        </li>
                        <li class="icons">
                            <a href="https://youtube.com" class="youtube">
                                <i class="fa-brands fa-youtube fa-2xl"></i>
                            </a>
                            <div class="tooltip">Youtube</div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="footer-text">
                <div class="contact-links">
                    <a href="../general/contact.html">Contact us</a>
                    <a href="../general/about.html">About us</a>
                </div>
                <hr>
                <div class="text">
                    <p>Kindessa would like to acknowledge the Traditional Custodians of the many lands on which we
                        live
                        and
                        work.<br>We would also like to pay respect to Elders past and present and extend that
                        respect to
                        all
                        Aboriginal and Torres Strait Islander Peoples.
                    </p>
                </div>
            </div>
        </div>
    </footer>
    <script>
        const postVue = new Vue({
            el: '#posts',
            data: {
                logged_in: false,
                check_manager: false,
                check_admin: false,
            },
            mounted() {
                this.check_login();
            },
            methods: {
                check_login() {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = () => {
                        if (xhttp.readyState === 4) {
                            if (xhttp.status === 200) {
                                const response = JSON.parse(xhttp.responseText);
                                this.logged_in = true;
                                this.check_manager = response.role_id === 'manager';
                                this.check_admin = response.role_id === 'admin';
                            } else {
                                this.logged_in = false;
                                this.check_manager = false;
                                this.check_admin = false;
                            }
                        }
                    };
                    xhttp.open('GET', '/check-login', true);
                    xhttp.send();
                },
                logout() {
                    fetch('/logout', {
                        method: 'POST',
                        credentials: 'same-origin'
                    })
                        .then(response => {
                            if (response.ok) {
                                console.log('Logout successful'); // Log success
                                this.logged_in = false;
                                window.location.href = '../index.html';
                            } else {
                                console.error('Logout failed'); // Log failure
                            }
                        })
                        .catch(error => {
                            console.error('Error during logout:', error);
                        });
                }
            }
        });
    </script>
</body>

</html>